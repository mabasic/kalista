#!/usr/bin/env php

<?php

use Illuminate\Filesystem\Filesystem;
use Mabasic\Kalista\Mappers\FileMapper;
//use Mabasic\Kalista\Movies\OrganizeCommand as OrganizeMovieCommand;
use Mabasic\Kalista\Movies\RenameCommand as RenameMovieCommand;
use Mabasic\Kalista\TvShows\RenameCommand as RenameTvShowEpisodesCommand;
//use Mabasic\Kalista\TVShows\OrganizeCommand as OrganizeTvShowCommand;
use Mabasic\Kalista\Services\Environmental\Environmental;
use Symfony\Component\Console\Application;

if (file_exists(__DIR__ . '/vendor/autoload.php'))
{
    // For development purposes
    require __DIR__ . '/vendor/autoload.php';
}
else
{
    // This is important because of bin executable
    require __DIR__ . '/../../autoload.php';
}

$app = new Application('Kalista', '0.10.0');

$filesystem = new Filesystem;
$environmental = new Environmental($filesystem);
$fileMapper = new FileMapper;

$app->add(new RenameMovieCommand($filesystem, $environmental, $fileMapper));
//$app->add(new OrganizeMovieCommand($allowed_extensions, $filebot, $filesystem, $moviesApi));

$app->add(new RenameTvShowEpisodesCommand($filesystem, $environmental, $fileMapper));
//$app->add(new OrganizeTvShowCommand($allowed_extensions, $filebot, $filesystem));

$app->run();